/**
 * Sina Particles v1.0
 * URI: https://github.com/shaonsina/sina-particles
 * Author: shaonsina
 */

!function(e){"use strict";var t,n;n={},e.fn.sinaParticles=function(e){return this.each(function(n,i){t(i,e)}),this},n.getRandNumber=function(e,t,n){var i;return null==e&&(e=0),null==t&&(t=10),null==n&&(n=!0),i=Math.random()*(t-e)+e,n?Math.round(i):i},n.getDistance=function(e,t,n,i){return Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))},n.getMousePosition=function(t,n){var i;return void 0===n&&(n=e("body")[0]),i=n.getBoundingClientRect(),{x:t.clientX-i.left,y:t.clientY-i.top}},t=function(t,i){var a,s;return(a={}).canvas={},a.mouse={},a.particles=[],a.isAnimated=!1,a.initialize=function(e,t){a.initParams(t),a.initHTML(e),a.initParticles(),a.initEvents(),a.initAnimation()},a.initParams=function(t){a.params=e.extend({particlesNumber:100,linkDist:100,createLinkDist:150,disableLinks:!1,disableMouse:!1,background:"transparent",lineColor:"#ddd",fillColor:"#ddd",width:null,height:null,linksWidth:1,minSize:2,maxSize:10,speed:20},t)},a.initHTML=function(t){var n;(n=a.canvas).container=e(t),n.element=e("<canvas/>"),n.context=n.element.get(0).getContext("2d"),n.container.append(n.element),n.element.css("display","block"),n.element.get(0).width=a.params.width?a.params.width:n.container.width(),n.element.get(0).height=a.params.height?a.params.height:n.container.height(),n.element.css("background",a.params.background)},a.initParticles=function(){var e,t;for(e=0,t=a.params.particlesNumber;e<t;e+=1)a.particles.push(s(a.canvas.element.get(0),a.params.particle))},a.initEvents=function(){a.canvas.element.mouseenter(function(){a.mouse.hoverCanvas=!0,a.isAnimated||a.draw()}),a.canvas.element.mouseleave(function(){a.mouse.hoverCanvas=!1}),a.canvas.element.mousemove(function(t){a.mouse=e.extend(a.mouse,n.getMousePosition(t,a.canvas.element[0]))})},a.initAnimation=function(){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.ORequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeOut(e,1e3/60)},a.isAnimated=!0,a.draw()},a.resize=function(e,t){e&&(canvas.element.get(0).width=e),t&&(canvas.element.get(0).height=t)},a.draw=function(){var e,t,n,i,s,o;for(e=0,n=a.particles.length,(i=a.canvas).context.clearRect(0,0,i.element.get(0).width,i.element.get(0).height);e<n;e+=1)if(s=a.particles[e],a.isAnimated&&s.update(),s.draw(),!a.params.disableMouse&&a.mouse.hoverCanvas&&a.drawLink(s.getPosition("x"),s.getPosition("y"),a.mouse.x,a.mouse.y),!a.params.disableLinks)for(t=e+1;t<n;t+=1)o=a.particles[t],a.drawLink(s.getPosition("x"),s.getPosition("y"),o.getPosition("x"),o.getPosition("y"));a.requestID=window.requestAnimFrame(a.draw)},a.drawLink=function(e,t,i,s){var o;n.getDistance(e,t,i,s)<=a.params.createLinkDist&&((o=a.canvas.context).save(),o.beginPath(),o.lineWidth=a.params.linksWidth,o.moveTo(e,t),o.lineTo(i,s),o.globalAlpha=a.getOpacityLink(e,t,i,s),o.strokeStyle=a.params.lineColor,o.lineCap="round",o.stroke(),o.closePath(),o.restore())},a.getOpacityLink=function(e,t,i,s){var o,r,c;return o=n.getDistance(e,t,i,s),r=a.params.linkDist,c=a.params.createLinkDist,o<=r?1:o>c?0:1-100*(o-r)/(c-r)/100},a.remove=function(){a.canvas.element.remove()},s=function(e,t){var i;return(i={}).canvas={},i.vector={},i.initialize=function(e,t){i.setCanvasContext(e),i.initSize(),i.initPosition(),i.initSpeed()},i.setCanvasContext=function(e){var t;if(i.canvas.element=e,"object"!=typeof(t=e.getContext("2d"))||"object"!=typeof t.canvas)throw"Error: Can't set canvas context to Particle";i.canvas.context=t},i.initSize=function(){i.size=n.getRandNumber(a.params.minSize,a.params.maxSize),i.radius=i.size/2},i.initPosition=function(){i.x=n.getRandNumber(0+i.radius,i.canvas.element.width-i.radius),i.y=n.getRandNumber(0+i.radius,i.canvas.element.height-i.radius)},i.initSpeed=function(){do{i.vector.x=n.getRandNumber(-a.params.speed/60,a.params.speed/60,!1),i.vector.y=n.getRandNumber(-a.params.speed/60,a.params.speed/60,!1)}while(0==i.vector.x||0==i.vector.y)},i.draw=function(){var e=i.canvas.context;e.beginPath(),e.arc(i.x,i.y,i.size/2,0,2*Math.PI),e.fillStyle=a.params.fillColor,e.fill(),e.closePath()},i.update=function(){i.x+=i.vector.x,i.y+=i.vector.y,(0>i.x-i.radius||i.x+i.radius>i.canvas.element.width)&&(i.vector.x=-i.vector.x),(0>i.y-i.radius||i.y+i.radius>i.canvas.element.height)&&(i.vector.y=-i.vector.y)},i.getPosition=function(e){return"string"==typeof e&&"x"!=e&&"y"!=e&&(e=null),"string"==typeof e?i[e]:{x:i.x,y:i.y}},i.initialize(e,t),{getPosition:i.getPosition,update:i.update,draw:i.draw}},a.initialize(t,i),{remove:a.remove,resize:a.resize}}}(jQuery);